---
- name: Create Support Case on Red Hat Customer Portal with OpenShift Must Gather
  hosts: localhost
  connection: local
  gather_facts: false

  vars_files:
    - vars/redhat-customer-portal-token.yml
    - vars/cluster-secret.yml
    - vars/redhat-create-customer-support-case.yml

  tasks:
    - name: Verify Cluster Information is provided
      ansible.builtin.assert:
        that:
          - ocp_cluster_name is defined and ocp_cluster_name | length > 0
          - ocp_base_domain is defined and ocp_base_domain | length > 0
        fail_msg:
          - "Check cluster information is properly provided"
          - '-e "ocp_cluster_name=<cluster_name>"'
          - '-e "ocp_base_domain=<base_domain>"'

    - name: "[INCLUDE ROLE] - Red Hat Customer Portal Auth"
      ansible.builtin.include_role:
        name: redhat-customer-portal-auth

    - name: "[INCLUDE ROLE] - Red Hat OpenShift Cluster Login"
      ansible.builtin.include_role:
        name: redhat-openshift-cluster-login

    - name: "[INCLUDE ROLE] - Red Hat OpenShift Generate Must Gather"
      ansible.builtin.include_role:
        name: redhat-openshift-generate-must-gather

    # - name: "[INCLUDE ROLE] - Red Hat Customer Portal Create Case"
    #   ansible.builtin.include_role:
    #     name: redhat-customer-portal-create-case

    # - name: "[INCLUDE ROLE] - Red Hat Customer Portal Add Comment to Case"
    #   ansible.builtin.include_role:
    #     name: redhat-customer-portal-add-case-comment

    # - name: "[INCLUDE ROLE] - Red Hat Customer Portal Add File to Case"
    #   ansible.builtin.include_role:
    #     name: redhat-customer-portal-add-file-to-case
...
